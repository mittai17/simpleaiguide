---
import Search from "./Search.astro";
const links = [
  { href: "/", label: "Home" },
  { href: "/learn", label: "Learn" },
  { href: "/blog", label: "Blog" },
  { href: "/about", label: "About" },
  { href: "/contact", label: "Contact" },
];
---

<nav
  class="sticky top-0 z-50 w-full border-b border-slate-100 bg-white/80 backdrop-blur supports-[backdrop-filter]:bg-white/60"
>
  <div class="container mx-auto flex h-16 items-center justify-between px-4">
    <a
      href="/"
      class="flex items-center gap-3 text-2xl font-extrabold tracking-tight text-slate-900 hover:text-indigo-600 transition-colors font-['Outfit']"
    >
      <img
        src="/assets/logo.png?v=2"
        alt="Simple AI Guide Logo"
        class="h-14 w-auto"
      />
      Simple <span class="text-indigo-600">AI Guide</span>
    </a>

    <div class="hidden md:flex items-center gap-6">
      <div class="flex gap-6 items-center">
        <a
          href="/"
          class="text-sm font-medium text-slate-600 hover:text-indigo-600 transition-colors"
          >Home</a
        >

        <!-- Learn Dropdown -->
        <div class="relative group">
          <button
            class="flex items-center gap-1 text-sm font-medium text-slate-600 hover:text-indigo-600 transition-colors focus:outline-none"
          >
            Learn
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="w-4 h-4 text-slate-400 group-hover:text-indigo-600 transition-colors"
            >
              <path
                fill-rule="evenodd"
                d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                clip-rule="evenodd"></path>
            </svg>
          </button>
          <div
            class="absolute top-full left-0 w-56 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform translate-y-2 group-hover:translate-y-0"
          >
            <div
              class="bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden p-2"
            >
              <a
                href="/learn/ai-basics"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >AI Basics</a
              >
              <a
                href="/learn/machine-learning"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Machine Learning</a
              >
              <a
                href="/learn/deep-learning"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Deep Learning</a
              >
              <a
                href="/learn/python-for-ai"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Python for AI</a
              >
              <a
                href="/learn/math-for-ai"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Math for AI</a
              >
            </div>
          </div>
        </div>

        <!-- Blog Dropdown -->
        <div class="relative group">
          <button
            class="flex items-center gap-1 text-sm font-medium text-slate-600 hover:text-indigo-600 transition-colors focus:outline-none"
          >
            Blog
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 20 20"
              fill="currentColor"
              class="w-4 h-4 text-slate-400 group-hover:text-indigo-600 transition-colors"
            >
              <path
                fill-rule="evenodd"
                d="M5.23 7.21a.75.75 0 011.06.02L10 11.168l3.71-3.938a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z"
                clip-rule="evenodd"></path>
            </svg>
          </button>
          <div
            class="absolute top-full left-0 w-56 pt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 transform translate-y-2 group-hover:translate-y-0"
          >
            <div
              class="bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden p-2"
            >
              <a
                href="/blog/best-ai-tools"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Best AI Tools</a
              >
              <a
                href="/blog/comparisons"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Comparisons</a
              >
              <a
                href="/blog/prompt-engineering"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Prompt Engineering</a
              >
              <a
                href="/blog/automation"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >Automation</a
              >
              <a
                href="/blog/news"
                class="block px-4 py-2 text-sm text-slate-600 hover:bg-indigo-50 hover:text-indigo-600 rounded-lg"
                >AI News</a
              >
            </div>
          </div>
        </div>

        <a
          href="/about"
          class="text-sm font-medium text-slate-600 hover:text-indigo-600 transition-colors"
          >About</a
        >
        <a
          href="/contact"
          class="text-sm font-medium text-slate-600 hover:text-indigo-600 transition-colors"
          >Contact</a
        >
      </div>
      <Search />
    </div>

    <!-- Mobile Menu Button -->
    <button
      id="mobile-menu-btn"
      class="md:hidden relative z-50 p-2 text-slate-600 hover:text-indigo-600 focus:outline-none"
      aria-label="Toggle menu"
    >
      <div class="w-6 h-5 relative flex flex-col justify-between">
        <span
          id="bar1"
          class="w-full h-0.5 bg-current rounded-full transition-all duration-300 origin-left"
        ></span>
        <span
          id="bar2"
          class="w-full h-0.5 bg-current rounded-full transition-all duration-300"
        ></span>
        <span
          id="bar3"
          class="w-full h-0.5 bg-current rounded-full transition-all duration-300 origin-left"
        ></span>
      </div>
    </button>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    id="mobile-menu"
    class="fixed inset-0 z-40 bg-white/95 backdrop-blur-xl md:hidden transition-all duration-300 ease-in-out opacity-0 invisible translate-x-full"
  >
    <div class="flex flex-col h-full pt-24 px-6 pb-8 overflow-y-auto">
      <div class="flex flex-col gap-2">
        <a
          href="/"
          class="text-2xl font-bold text-slate-900 py-4 border-b border-slate-100"
          >Home</a
        >

        <!-- Learn Accordion -->
        <div class="border-b border-slate-100 py-4">
          <button
            class="flex items-center justify-between w-full text-2xl font-bold text-slate-900 focus:outline-none accordion-btn"
            data-target="learn-accordion"
          >
            Learn
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
              class="w-6 h-6 transition-transform duration-300"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path>
            </svg>
          </button>
          <div
            id="learn-accordion"
            class="max-h-0 overflow-hidden transition-all duration-300 ease-in-out"
          >
            <div class="flex flex-col gap-3 pt-4 pl-2">
              <a
                href="/learn/ai-basics"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >AI Basics</a
              >
              <a
                href="/learn/machine-learning"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Machine Learning</a
              >
              <a
                href="/learn/deep-learning"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Deep Learning</a
              >
              <a
                href="/learn/python-for-ai"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Python for AI</a
              >
              <a
                href="/learn/math-for-ai"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Math for AI</a
              >
            </div>
          </div>
        </div>

        <!-- Blog Accordion -->
        <div class="border-b border-slate-100 py-4">
          <button
            class="flex items-center justify-between w-full text-2xl font-bold text-slate-900 focus:outline-none accordion-btn"
            data-target="blog-accordion"
          >
            Blog
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="2"
              stroke="currentColor"
              class="w-6 h-6 transition-transform duration-300"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path>
            </svg>
          </button>
          <div
            id="blog-accordion"
            class="max-h-0 overflow-hidden transition-all duration-300 ease-in-out"
          >
            <div class="flex flex-col gap-3 pt-4 pl-2">
              <a
                href="/blog/best-ai-tools"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Best AI Tools</a
              >
              <a
                href="/blog/comparisons"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Comparisons</a
              >
              <a
                href="/blog/prompt-engineering"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Prompt Engineering</a
              >
              <a
                href="/blog/automation"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >Automation</a
              >
              <a
                href="/blog/news"
                class="text-lg font-medium text-slate-600 hover:text-indigo-600"
                >AI News</a
              >
            </div>
          </div>
        </div>

        <a
          href="/about"
          class="text-2xl font-bold text-slate-900 py-4 border-b border-slate-100"
          >About</a
        >
        <a
          href="/contact"
          class="text-2xl font-bold text-slate-900 py-4 border-b border-slate-100"
          >Contact</a
        >
      </div>

      <div class="mt-8">
        <Search />
      </div>
    </div>
  </div>
</nav>

<script>
  const btn = document.getElementById("mobile-menu-btn");
  const menu = document.getElementById("mobile-menu");
  const bar1 = document.getElementById("bar1");
  const bar2 = document.getElementById("bar2");
  const bar3 = document.getElementById("bar3");
  const accordionBtns = document.querySelectorAll(".accordion-btn");
  let isMenuOpen = false;

  btn?.addEventListener("click", () => {
    isMenuOpen = !isMenuOpen;

    if (isMenuOpen) {
      // Open Menu
      menu?.classList.remove("opacity-0", "invisible", "translate-x-full");
      menu?.classList.add("opacity-100", "visible", "translate-x-0");
      document.body.style.overflow = "hidden"; // Prevent scrolling

      // Animate Hamburger to X
      bar1?.classList.add("rotate-45", "translate-x-1", "-translate-y-0.5");
      bar2?.classList.add("opacity-0");
      bar3?.classList.add("-rotate-45", "translate-x-1", "translate-y-0.5");
    } else {
      // Close Menu
      menu?.classList.add("opacity-0", "invisible", "translate-x-full");
      menu?.classList.remove("opacity-100", "visible", "translate-x-0");
      document.body.style.overflow = ""; // Restore scrolling

      // Animate X back to Hamburger
      bar1?.classList.remove("rotate-45", "translate-x-1", "-translate-y-0.5");
      bar2?.classList.remove("opacity-0");
      bar3?.classList.remove("-rotate-45", "translate-x-1", "translate-y-0.5");
    }
  });

  // Accordion Logic
  accordionBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      const targetId = btn.getAttribute("data-target");
      const content = document.getElementById(targetId!);
      const icon = btn.querySelector("svg");

      if (content?.style.maxHeight) {
        content.style.maxHeight = "";
        icon?.classList.remove("rotate-180");
      } else {
        content!.style.maxHeight = content!.scrollHeight + "px";
        icon?.classList.add("rotate-180");
      }
    });
  });
</script>
