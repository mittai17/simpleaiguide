---
interface Props {
    headings: { depth: number; slug: string; text: string }[];
}

const { headings } = Astro.props;

// Only show h2 and h3
const filteredHeadings = headings.filter((h) => h.depth === 2 || h.depth === 3);
---

<div class="lg:hidden mb-8">
    <details
        class="group bg-slate-50 rounded-xl border border-slate-200 overflow-hidden"
    >
        <summary
            class="flex items-center justify-between p-4 cursor-pointer list-none text-slate-900 font-bold select-none group-open:bg-slate-100 transition-colors"
        >
            <span class="flex items-center gap-2">
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="currentColor"
                    class="w-5 h-5 text-indigo-600"
                >
                    <path
                        fill-rule="evenodd"
                        d="M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z"
                        clip-rule="evenodd"></path>
                </svg>
                Table of Contents
            </span>
            <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
                class="w-4 h-4 text-slate-500 transition-transform group-open:rotate-180"
            >
                <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M19.5 8.25l-7.5 7.5-7.5-7.5"></path>
            </svg>
        </summary>
        <div class="p-4 border-t border-slate-200 bg-white">
            <ul class="space-y-3 text-sm">
                {
                    filteredHeadings.map((heading) => (
                        <li
                            class={`transition-colors hover:text-indigo-600 ${
                                heading.depth === 3
                                    ? "pl-4 text-slate-500"
                                    : "text-slate-700 font-medium"
                            }`}
                        >
                            <a href={`#${heading.slug}`} class="block py-1">
                                {heading.text}
                            </a>
                        </li>
                    ))
                }
            </ul>
        </div>
    </details>
</div>
